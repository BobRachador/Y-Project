{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\umami\\\\Downloads\\\\Y 1.0.8\\\\Telas\\\\Feed.js\",\n  _this = this;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useEffect, useState, useCallback } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { collection, getDocs, doc, getDoc, query, orderBy } from 'firebase/firestore';\nimport { firestore, auth } from '../firebase/config';\nimport PostItem from './PostItem';\nimport { BlurView } from 'expo-blur';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Feed = function Feed() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    posts = _useState2[0],\n    setPosts = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userId = _useState4[0],\n    setUserId = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    visible = _useState6[0],\n    setVisible = _useState6[1];\n  var nav = useNavigation();\n  useFocusEffect(useCallback(function () {\n    var unsubscribe = auth.onAuthStateChanged(function (user) {\n      if (user) {\n        setUserId(user.uid);\n        setVisible(false);\n      } else {\n        setUserId(null);\n        var timer = setTimeout(function () {\n          setVisible(true);\n        }, 5000);\n        return function () {\n          return clearTimeout(timer);\n        };\n      }\n    });\n    var fetchPosts = function () {\n      var _ref = _asyncToGenerator(function* () {\n        try {\n          var postsQuery = query(collection(firestore, 'posts'), orderBy('data', 'desc'));\n          var postSnapshot = yield getDocs(postsQuery);\n          var postList = yield Promise.all(postSnapshot.docs.map(function () {\n            var _ref2 = _asyncToGenerator(function* (postDoc) {\n              var postData = _objectSpread({\n                id: postDoc.id\n              }, postDoc.data());\n              if (postData.autor) {\n                var userDocRef = doc(firestore, 'users', postData.autor);\n                var userDoc = yield getDoc(userDocRef);\n                postData.autor = userDoc.exists() ? _objectSpread({\n                  id: userDoc.id\n                }, userDoc.data()) : null;\n              } else {\n                postData.autor = null;\n              }\n              return postData;\n            });\n            return function (_x) {\n              return _ref2.apply(this, arguments);\n            };\n          }()));\n          setPosts(postList);\n        } catch (error) {\n          console.error(\"Erro ao buscar posts: \", error);\n        }\n      });\n      return function fetchPosts() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    fetchPosts();\n    return function () {\n      return unsubscribe();\n    };\n  }, []));\n  function logon() {\n    nav.navigate('Person');\n  }\n  return _jsxDEV(View, {\n    style: {\n      flex: 1\n    },\n    children: [visible && _jsxDEV(BlurView, {\n      intensity: 75,\n      style: {\n        position: 'absolute',\n        width: '100%',\n        textAlign: 'center',\n        justifyContent: 'center',\n        overflow: 'hidden',\n        height: '100%',\n        zIndex: 2\n      },\n      children: _jsxDEV(View, {\n        style: {\n          backgroundColor: '#FFF',\n          borderColor: '#dedede',\n          padding: 20,\n          borderWidth: 1,\n          borderRadius: 24,\n          justifyContent: 'center',\n          alignItems: 'center',\n          marginHorizontal: '10%'\n        },\n        children: [_jsxDEV(Text, {\n          style: {\n            textAlign: 'center',\n            borderBottomWidth: 1,\n            fontSize: 24,\n            fontWeight: '400'\n          },\n          children: \"\\uD835\\uDD50\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, _this), _jsxDEV(Text, {\n          style: {\n            textAlign: 'center',\n            marginTop: 5\n          },\n          children: \"Entre para continuar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, _this), _jsxDEV(TouchableOpacity, {\n          onPress: logon,\n          children: _jsxDEV(Text, {\n            style: {\n              textAlign: 'center',\n              backgroundColor: '#00BFFF',\n              padding: 5,\n              borderRadius: 24,\n              fontSize: 18,\n              margin: 10,\n              color: '#FFF'\n            },\n            children: \"Cadastrar/Entrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, _this), _jsxDEV(FlatList, {\n      data: posts,\n      renderItem: function renderItem(_ref3) {\n        var item = _ref3.item;\n        return _jsxDEV(PostItem, {\n          texto: item.texto,\n          img: item.img,\n          autor: item.autor,\n          id: item.id,\n          userId: userId,\n          dell: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, _this);\n      },\n      keyExtractor: function keyExtractor(item) {\n        return item.id;\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, _this);\n};\nexport default Feed;","map":{"version":3,"names":["React","useEffect","useState","useCallback","View","Text","FlatList","TouchableOpacity","collection","getDocs","doc","getDoc","query","orderBy","firestore","auth","PostItem","BlurView","useNavigation","useFocusEffect","jsxDEV","_jsxDEV","Feed","_useState","_useState2","_slicedToArray","posts","setPosts","_useState3","_useState4","userId","setUserId","_useState5","_useState6","visible","setVisible","nav","unsubscribe","onAuthStateChanged","user","uid","timer","setTimeout","clearTimeout","fetchPosts","_ref","_asyncToGenerator","postsQuery","postSnapshot","postList","Promise","all","docs","map","_ref2","postDoc","postData","_objectSpread","id","data","autor","userDocRef","userDoc","exists","_x","apply","arguments","error","console","logon","navigate","style","flex","children","intensity","position","width","textAlign","justifyContent","overflow","height","zIndex","backgroundColor","borderColor","padding","borderWidth","borderRadius","alignItems","marginHorizontal","borderBottomWidth","fontSize","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","_this","marginTop","onPress","margin","color","renderItem","_ref3","item","texto","img","dell","keyExtractor"],"sources":["C:/Users/umami/Downloads/Y 1.0.8/Telas/Feed.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { View, Text, FlatList, TouchableOpacity } from 'react-native';\nimport { collection, getDocs, doc, getDoc, query, orderBy } from 'firebase/firestore';\nimport { firestore, auth } from '../firebase/config';\nimport PostItem from './PostItem';\nimport { BlurView } from 'expo-blur';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\n\nconst Feed = () => {\n  const [posts, setPosts] = useState([]);\n  const [userId, setUserId] = useState(null);\n  const [visible, setVisible] = useState(null);\n  const nav = useNavigation();\n\n  useFocusEffect(\n    useCallback(() => {\n      const unsubscribe = auth.onAuthStateChanged(user => {\n        if (user) {\n          setUserId(user.uid);\n          setVisible(false);\n        } else {\n          setUserId(null);\n          const timer = setTimeout(() => {\n            setVisible(true);\n          }, 5000); // Espera 5 segundos\n\n          // Limpa o timer se o componente for desmontado\n          return () => clearTimeout(timer);\n        }\n      });\n\n      const fetchPosts = async () => {\n        try {\n          const postsQuery = query(collection(firestore, 'posts'), orderBy('data', 'desc'));\n          const postSnapshot = await getDocs(postsQuery);\n\n          const postList = await Promise.all(\n            postSnapshot.docs.map(async (postDoc) => {\n              const postData = { id: postDoc.id, ...postDoc.data() };\n\n              if (postData.autor) {\n                const userDocRef = doc(firestore, 'users', postData.autor);\n                const userDoc = await getDoc(userDocRef);\n                postData.autor = userDoc.exists() ? { id: userDoc.id, ...userDoc.data() } : null;\n              } else {\n                postData.autor = null;\n              }\n              return postData;\n            })\n          );\n\n          setPosts(postList);\n        } catch (error) {\n          console.error(\"Erro ao buscar posts: \", error);\n        }\n      };\n\n      fetchPosts();\n      \n      return () => unsubscribe();\n    }, [])\n  );\n\n  function logon() {\n    nav.navigate('Person');\n  }\n\n  return (\n    <View style={{ flex: 1 }}>\n      {visible && ( // Renderiza a mensagem de login apenas se 'visible' for true\n        <BlurView\n          intensity={75}\n          style={{\n            position: 'absolute',\n            width: '100%',\n            textAlign: 'center',\n            justifyContent: 'center',\n            overflow: 'hidden',\n            height: '100%',\n            zIndex: 2,\n          }}\n        >\n          <View\n            style={{\n              backgroundColor: '#FFF',\n              borderColor: '#dedede',\n              padding: 20,\n              borderWidth: 1,\n              borderRadius: 24,\n              justifyContent: 'center',\n              alignItems: 'center',\n              marginHorizontal: '10%',\n            }}\n          >\n            <Text style={{ textAlign: 'center', borderBottomWidth: 1, fontSize: 24, fontWeight: '400' }}>𝕐</Text>\n            <Text style={{ textAlign: 'center', marginTop: 5 }}>Entre para continuar</Text>\n            <TouchableOpacity onPress={logon}>\n              <Text\n                style={{\n                  textAlign: 'center',\n                  backgroundColor: '#00BFFF',\n                  padding: 5,\n                  borderRadius: 24,\n                  fontSize: 18,\n                  margin: 10,\n                  color: '#FFF',\n                }}\n              >\n                Cadastrar/Entrar\n              </Text>\n            </TouchableOpacity>\n          </View>\n        </BlurView>\n      )}\n      <FlatList\n        data={posts}\n        renderItem={({ item }) => (\n          <PostItem\n            texto={item.texto}\n            img={item.img}\n            autor={item.autor}\n            id={item.id}\n            userId={userId}\n            dell={false}\n          />\n        )}\n        keyExtractor={(item) => item.id}\n      />\n    </View>\n  );\n};\n\nexport default Feed;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}